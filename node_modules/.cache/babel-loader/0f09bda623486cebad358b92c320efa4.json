{"ast":null,"code":"var _jsxFileName = \"/Users/larainefajardo/Desktop/web_app/_progressive_web_app/react/companion/src/shared/login.js\";\nimport React, { Component, Fragment } from 'react';\nimport { Link, withRouter } from 'react-router-dom'; // import { Helmet } from 'react-helmet';\n\nimport { writeData } from '../utils/db.js';\nimport { Loader } from '../utils/utilityViews';\nimport { myConfig } from '../utils/config';\nimport { encrypt } from '../utils/security';\nimport { urlBase64ToUint8Array, jsonToURI } from '../utils/utility'; // import '../styles/App.css';\n\nimport { styles } from '../styles/styles.js';\nimport PasswordField from '../components/Login/passwordField';\nimport { apiModule } from '../api/apiCall';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n\n    this.loginThirdParty = userData => {\n      const that = this;\n      let postData = {\n        email: userData.email,\n        password: 'fb_login'\n      };\n      apiModule('authentication_login', {}, postData).then(data => {\n        if (data.result === 'success') {\n          that.getSession(data);\n        } else {\n          this.setState({\n            isLoading: false\n          });\n          window.confirm(data.message);\n        }\n      });\n    };\n\n    this.handlePasswordReadability = () => {\n      this.state.passwordReadable === true ? this.setState({\n        passwordReadable: false\n      }) : this.setState({\n        passwordReadable: true\n      });\n    };\n\n    this.configurePushSub = () => {\n      let that = this;\n      console.log('configurePushSub ServiceWorker');\n\n      if (!('serviceWorker' in navigator)) {\n        console.log('No ServiceWorker');\n        return;\n      }\n\n      if ('PushManager' in window) {\n        console.log('We have a push manager');\n        var reg;\n        navigator.serviceWorker.ready.then(function (swreg) {\n          reg = swreg;\n          console.log('navigator.serviceWorker.ready');\n          console.log(swreg);\n          let pushManager = swreg.pushManager;\n          console.log(pushManager);\n          return pushManager.getSubscription();\n        }).then(function (sub) {\n          if (sub === null) {\n            // Create a new subscription\n            var vapidPublicKey = myConfig.WEB_PUSH_PUBLIC_KEY;\n            var convertedVapidPublicKey = urlBase64ToUint8Array(vapidPublicKey);\n            console.log('Create a new subscription ' + myConfig.WEB_PUSH_PUBLIC_KEY);\n            return reg.pushManager.subscribe({\n              userVisibleOnly: true,\n              applicationServerKey: convertedVapidPublicKey\n            });\n          } else {\n            // We have a subscription\n            console.log('We have a subscription');\n            console.log(sub);\n            return sub;\n          }\n        }).then(function (newSub) {\n          let webpushObject = {\n            'webpush': JSON.stringify(newSub),\n            'type': 'default_push_type'\n          }; // that.displayConfirmNotification();\n\n          console.log(newSub);\n          let request = {\n            x_auth: that.props.getSession().jwt\n          };\n          return apiModule('user_store_vapid', request, webpushObject);\n        }).then(function (res) {\n          console.log(res);\n        }).catch(function (err) {\n          console.log(\"Error : \" + err);\n        });\n      } else {}\n    };\n\n    this.callbackSidebar = permissionData => {\n      let that = this;\n\n      if (permissionData.permission === \"granted\") {\n        let webpushObject = {\n          'webpush': permissionData.deviceToken,\n          'type': 'safari_push_type'\n        };\n        let data = jsonToURI(webpushObject);\n        return apiModule('user_store_vapid', that.props.getSession().jwt, data);\n      }\n    };\n\n    this.askForNotificationPermission = () => {\n      let that = this;\n\n      if ('PushManager' in window) {\n        Notification.requestPermission(function (result) {\n          console.log('User Choice', result);\n\n          if (result !== 'granted') {\n            console.log('Not granted');\n          } else {\n            that.configurePushSub();\n          }\n        });\n      } else {\n        console.log('Sorry no push manager. Trying safari server...');\n        let result = window.safari.pushNotification.permission(myConfig.SAFARI_WEB_PUSH_ID);\n\n        if (result.permission === \"default\" || result.permission === \"denied\") {\n          window.safari.pushNotification.requestPermission(myConfig.SERVER_URL, myConfig.SAFARI_WEB_PUSH_ID, {}, that.callbackSidebar);\n        } else {\n          console.log(result.permission);\n        }\n\n        console.log(result);\n      }\n    };\n\n    this.state = {\n      username: '',\n      businesstype: '',\n      dbP: undefined,\n      isLoading: false,\n      businesstypeClasses: \"input100 select_force\",\n      businesstypeValidation: \"wrap-input100 validate-inpu m-b-35\",\n      businesstypeMessage: \"Enter Business Type\",\n      usernameClasses: \"input100\",\n      usernameValidation: \"wrap-input100 validate-input m-b-35\",\n      usernameMessage: \"Enter username\",\n      password: '',\n      passClasses: \"input100\",\n      passwordReadable: false,\n      passwordMessage: \"Enter password\",\n      passwordValidation: \"wrap-input100 validate-input m-b-50\"\n    };\n    this.FB = window.FB;\n    this.handleChangeUsername = this.handleChangeUsername.bind(this);\n    this.handleChangePass = this.handleChangePass.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    let that = this;\n\n    try {\n      window.FB.XFBML.parse();\n      console.log(this.props.auth.isAuthenticated);\n      this.props.auth.signout();\n      window.FB.Event.subscribe('auth.statusChange', response => {\n        if (response.status === \"connected\") {\n          console.log(response);\n          that.setState({\n            isLoading: true\n          });\n          window.FB.api('/me', {\n            fields: 'email,name,picture'\n          }, userData => {\n            let registerUser = {\n              thirdparty_id: userData.id,\n              thirdpart_source: 'facebook',\n              email: userData.email,\n              password: 'fb_login',\n              full_name: userData.name\n            };\n            apiModule('authentication_register', {}, registerUser).then(() => {\n              that.loginThirdParty(userData);\n            });\n          });\n        } else {\n          window.FB.login(response => {\n            if (response.authSuccess) {\n              // dispatch(oauth(\"facebook\"));\n              console.log(response);\n            }\n          }, {\n            scope: \"email,public_profile\",\n            info_fields: \"email,name\"\n          });\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n  }\n\n  onSuccess(googleUser) {\n    try {\n      console.log('Logged in as: ' + window.googleUser.getBasicProfile().getName());\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  onFailure(error) {\n    console.log(error);\n  }\n\n  renderButton() {\n    window.gapi.signin2.render('my-signin2', {\n      'scope': 'profile username',\n      'width': 240,\n      'height': 50,\n      'longtitle': true,\n      'theme': 'dark',\n      'onsuccess': this.onSuccess(),\n      'onfailure': this.onFailure()\n    });\n  }\n\n  handleChangeUsername(event) {\n    this.setState({\n      username: event.target.value\n    });\n    if (event.target.value) this.setState({\n      usernameClasses: \"input100 has-val\",\n      usernameMessage: \"Enter username\",\n      usernameValidation: \"wrap-input100 validate-input m-b-35\"\n    });else this.setState({\n      usernameClasses: \"input100\",\n      usernameMessage: \"Enter username\",\n      usernameValidation: \"wrap-input100 validate-input m-b-35 alert-validate\"\n    });\n  }\n\n  handleChangeBusinesstype(event) {\n    this.setState({\n      businesstype: event.target.value\n    });\n    if (event.target.value) this.setState({\n      businesstypeClasses: \"input100 has-val select_force\",\n      businesstypeMessage: \"Enter Valid Business Type\",\n      businesstypeValidation: \"wrap-input100 validate-input m-t-85 m-b-35\"\n    });else this.setState({\n      businesstypeClasses: \"input100 select_force\",\n      businesstypeMessage: \"Enter Business Type\",\n      businesstypeValidation: \"wrap-input100 validate-input m-t-85 m-b-35 alert-validate\"\n    });\n  }\n\n  handleChangePass(event) {\n    this.setState({\n      password: event.target.value\n    });\n    if (event.target.value) this.setState({\n      passClasses: \"input100 has-val\",\n      passwordValidation: \"wrap-input100 validate-input m-b-50\"\n    });else this.setState({\n      passClasses: \"input100\",\n      passwordMessage: \"Enter password\",\n      passwordValidation: \"wrap-input100 validate-input m-b-50 alert-validate\"\n    });\n  }\n\n  validateField(fieldName, value) {\n    let username = true;\n    let password = true;\n    let businesstype = true;\n\n    if (this.state.username.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) === false) {\n      this.setState({\n        usernameValidation: \"wrap-input100 validate-input m-t-85 m-b-35 alert-validate\",\n        usernameMessage: \"Enter username\"\n      });\n      username = false;\n    }\n\n    if (!this.state.password) {\n      password = false;\n      this.setState({\n        passwordValidation: \"wrap-input100 validate-input m-b-50 alert-validate\"\n      });\n    }\n\n    if (!this.state.username) {\n      this.setState({\n        usernameValidation: \"wrap-input100 validate-input m-b-35 alert-validate\",\n        usernameMessage: \"Enter username\"\n      });\n      username = false;\n    }\n\n    if (!this.state.businesstype) {\n      this.setState({\n        businesstypeValidation: \"wrap-input100 validate-input m-t-85 force_padding m-b-35 alert-validate\",\n        businesstypeMessage: \"Enter business type\"\n      });\n      businesstype = false;\n    } // return username === true && password === true ? true : false;\n\n\n    return username === true && password === true && businesstype === true;\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n    let bool = this.validateField(event);\n    console.log(\"Bool\", bool);\n\n    if (bool) {\n      this.setState({\n        isLoading: true\n      });\n      const that = this;\n      let postData = {\n        username: this.state.username,\n        password: this.state.password,\n        businesstype: this.state.businesstype\n      }; // let post = jsonToURI(postData);\n\n      let data = await apiModule('authentication_login', {}, postData);\n\n      if (data.result === 'success') {\n        this.setState({\n          isLoading: false\n        });\n        this.getSession(data);\n      } else {\n        this.setState({\n          isLoading: false\n        });\n\n        if (data.result === 'expired_password') {\n          that.props.changePageHandler(\"ResetPassword\");\n        } else {\n          window.confirm(data.message);\n        }\n      }\n    }\n  }\n\n  getSession(data) {\n    const that = this; // const userData = data.user;\n\n    const userData = {\n      contact_number: data.user.contact_number ? encrypt(data.user.contact_number) : \"\",\n      email: encrypt(data.user.email),\n      full_name: encrypt(data.user.full_name),\n      role: data.user.role,\n      business: data.user.business,\n      id: data.user.id\n    };\n    let result = {\n      jwt: data.message,\n      full_name: encrypt(data.user.full_name),\n      user: Object.keys(userData).length ? userData : {},\n      id: 1\n    };\n\n    if (data.user.role.name === \"Customer\") {\n      console.log(data);\n\n      if (data.user.customer) {\n        result.customer = {\n          shipTos: data.user.customer.shipTos,\n          customerType: data.user.customer.customerType,\n          soldTo: data.user.customer.soldTo,\n          soldToName: data.user.customer.soldToName,\n          soldToAddress: data.user.customer.soldToAddress\n        };\n      } else {\n        result.customer = {\n          shipTos: null,\n          customerType: null,\n          soldTo: null,\n          soldToName: null,\n          soldToAddress: null\n        };\n      }\n    }\n\n    writeData('users', result);\n    let user = {\n      jwt: data.message,\n      full_name: encrypt(data.user.full_name),\n      user: Object.keys(userData).length ? userData : {}\n    };\n\n    if (data.user.role.name === \"Customer\") {\n      user.customer = data.user.customer;\n    }\n\n    that.props.setUserSession(user);\n    that.setState({\n      isLoading: false\n    });\n    that.askForNotificationPermission();\n    that.props.history.push({\n      pathname: '/dashboard/home'\n    });\n  }\n  /*NOTIFICATION FUNCTIONS*/\n  // displayConfirmNotification = () => {\n  //   if ('serviceWorker' in navigator) {\n  //     var options = {\n  //       body: message.SUCCESS_PUSH_REGISTRATION,\n  //       icon: 'icons/icon-96x96.png',\n  //       image: 'icons/icon-96x96.png',\n  //       lang: 'en-US', //BCP 47\n  //       vibrate: [100, 50, 200], //vibration pause vibration pause..\n  //       badge: 'icons/icon-96x96.png',\n  //       dir: 'ltr',\n  //       tag: 'confirm-notification',\n  //       renotify: true,\n  //       actions: [\n  //         { action: 'confirm', title: 'Okay' },\n  //         { action: 'cancel', title: 'Cancel' }\n  //       ]\n  //     };\n  //     navigator.serviceWorker.ready\n  //       .then(function (swreg) {\n  //         swreg.showNotification('Successfully subscribed', options)\n  //       });\n  //   }\n  // }\n\n\n  /* END NOTIFICATION FUNCTION */\n  render() {\n    var isSafari = window.safari != undefined;\n    return /*#__PURE__*/_jsxDEV(Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"limiter\",\n        style: styles.templateSkin,\n        children: [/*#__PURE__*/_jsxDEV(\"section\", {\n          className: \"login-form\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"login-form-wrapper p-t-85 p-b-20\",\n            children: /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: this.handleSubmit,\n              className: \"login100-form validate-form\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"login100-form-title login\",\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  className: \"login100-form login100-form__logo\",\n                  src: require(\"../assets/images/delivery-system.png\"),\n                  alt: \"company logo\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 415,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 414,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: this.state.businesstypeValidation,\n                \"data-validate\": this.state.businesstypeMessage,\n                children: [isSafari ? /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: this.state.businesstype,\n                  onChange: event => this.handleChangeBusinesstype(event),\n                  className: this.state.businesstypeClasses,\n                  name: \"businesstype\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    hidden: true,\n                    disabled: true,\n                    defaultValue: true,\n                    children: \"\\xA0\\xA0\\xA0\\xA0\\xA0Business Type\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 422,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PP\",\n                    children: \"\\xA0\\xA0\\xA0\\xA0\\xA0Phoenix Petroleum\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 423,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"JA\",\n                    children: \"\\xA0\\xA0\\xA0\\xA0\\xA0Jet A1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 424,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PSL\",\n                    children: \"\\xA0\\xA0\\xA0\\xA0\\xA0Phoenix Super LPG\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 425,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PL\",\n                    children: \"\\xA0\\xA0\\xA0\\xA0\\xA0Phoenix Lubricants\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 426,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 421,\n                  columnNumber: 21\n                }, this) : /*#__PURE__*/_jsxDEV(\"select\", {\n                  value: this.state.businesstype,\n                  onChange: event => this.handleChangeBusinesstype(event),\n                  className: this.state.businesstypeClasses,\n                  name: \"businesstype\",\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"\",\n                    hidden: true,\n                    disabled: true,\n                    defaultValue: true,\n                    children: \"Business Type\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 430,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PP\",\n                    children: \"Phoenix Petroleum\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 431,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"JA\",\n                    children: \"Jet A1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 432,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PSL\",\n                    children: \" Phoenix Super LPG\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 433,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"PL\",\n                    children: \"Phoenix Lubricants\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 434,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 429,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"focus-input100 style_icon icomoon i-business-type\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 439,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 417,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: this.state.usernameValidation,\n                \"data-validate\": this.state.usernameMessage,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  value: this.state.username,\n                  onChange: event => this.handleChangeUsername(event),\n                  className: this.state.usernameClasses,\n                  type: \"text\",\n                  name: \"username\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"focus-input100 wrap-input__email\",\n                  \"data-placeholder\": \"Username\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 443,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(PasswordField, {\n                fieldName: \"pass\",\n                containerClass: this.state.passwordValidation,\n                fieldClass: this.state.passClasses,\n                fieldValue: this.state.password,\n                changeHandler: this.handleChangePass,\n                readabilityHandler: this.handlePasswordReadability,\n                readabilityIcon: true,\n                readabilityClass: this.state.passwordReadable,\n                children: \"Password\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 445,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"login-form-form-btn\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"login100-form-btn\",\n                  children: \"Log In\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 461,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 460,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"regular-label forgot-label\",\n                children: /*#__PURE__*/_jsxDEV(\"u\", {\n                  className: \"regular__link\",\n                  onClick: () => this.props.changePageHandler(\"ForgotPassword\"),\n                  children: /*#__PURE__*/_jsxDEV(Link, {\n                    style: {\n                      textDecoration: 'none',\n                      color: '#000000'\n                    },\n                    to: \"/forgot-password\",\n                    children: \"Forgot your password?\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 463,\n                    columnNumber: 156\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 463,\n                  columnNumber: 63\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 463,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 413,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"login-form-footer\",\n              children: [/*#__PURE__*/_jsxDEV(\"a\", {\n                target: \"_blank\",\n                href: \"https://www.phoenixfuels.ph/contact-us\",\n                className: \"login-form-footer__text pr-1\",\n                children: \"Contact |\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 468,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n                target: \"_blank\",\n                href: \"https://www.phoenixfuels.ph\",\n                className: \"login-form-footer__text\",\n                children: \"Phoenix Petroleum Philippines, Inc. | Copyright 2019\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 469,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 467,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 411,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"figure\", {\n          className: \"login-image\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            className: \"login-image__background\",\n            src: require(\"../assets/images/bg-login.png\"),\n            alt: \"login background\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 474,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 473,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Loader, {\n          show: this.state.isLoading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c = withRouter(Login);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/Users/larainefajardo/Desktop/web_app/_progressive_web_app/react/companion/src/shared/login.js"],"names":["React","Component","Fragment","Link","withRouter","writeData","Loader","myConfig","encrypt","urlBase64ToUint8Array","jsonToURI","styles","PasswordField","apiModule","Login","constructor","props","loginThirdParty","userData","that","postData","email","password","then","data","result","getSession","setState","isLoading","window","confirm","message","handlePasswordReadability","state","passwordReadable","configurePushSub","console","log","navigator","reg","serviceWorker","ready","swreg","pushManager","getSubscription","sub","vapidPublicKey","WEB_PUSH_PUBLIC_KEY","convertedVapidPublicKey","subscribe","userVisibleOnly","applicationServerKey","newSub","webpushObject","JSON","stringify","request","x_auth","jwt","res","catch","err","callbackSidebar","permissionData","permission","deviceToken","askForNotificationPermission","Notification","requestPermission","safari","pushNotification","SAFARI_WEB_PUSH_ID","SERVER_URL","username","businesstype","dbP","undefined","businesstypeClasses","businesstypeValidation","businesstypeMessage","usernameClasses","usernameValidation","usernameMessage","passClasses","passwordMessage","passwordValidation","FB","handleChangeUsername","bind","handleChangePass","handleSubmit","componentDidMount","XFBML","parse","auth","isAuthenticated","signout","Event","response","status","api","fields","registerUser","thirdparty_id","id","thirdpart_source","full_name","name","login","authSuccess","scope","info_fields","e","onSuccess","googleUser","getBasicProfile","getName","onFailure","error","renderButton","gapi","signin2","render","event","target","value","handleChangeBusinesstype","validateField","fieldName","match","preventDefault","bool","changePageHandler","contact_number","user","role","business","Object","keys","length","customer","shipTos","customerType","soldTo","soldToName","soldToAddress","setUserSession","history","push","pathname","isSafari","templateSkin","require","textDecoration","color"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from 'react';\nimport { Link, withRouter } from 'react-router-dom';\n// import { Helmet } from 'react-helmet';\nimport { writeData } from '../utils/db.js';\nimport { Loader } from '../utils/utilityViews';\nimport { myConfig } from '../utils/config';\nimport { encrypt } from '../utils/security';\nimport { urlBase64ToUint8Array, jsonToURI } from '../utils/utility';\n// import '../styles/App.css';\nimport { styles } from '../styles/styles.js';\nimport PasswordField from '../components/Login/passwordField';\nimport { apiModule } from '../api/apiCall';\n\nclass Login extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: '',\n      businesstype: '',\n      dbP: undefined,\n      isLoading: false,\n\n      businesstypeClasses: \"input100 select_force\",\n      businesstypeValidation: \"wrap-input100 validate-inpu m-b-35\",\n      businesstypeMessage: \"Enter Business Type\",\n\n      usernameClasses: \"input100\",\n      usernameValidation: \"wrap-input100 validate-input m-b-35\",\n      usernameMessage: \"Enter username\",\n\n      password: '',\n      passClasses: \"input100\",\n      passwordReadable: false,\n      passwordMessage: \"Enter password\",\n      passwordValidation: \"wrap-input100 validate-input m-b-50\",\n    };\n    this.FB = window.FB;\n    this.handleChangeUsername = this.handleChangeUsername.bind(this);\n    this.handleChangePass = this.handleChangePass.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    let that = this;\n    try {\n      window.FB.XFBML.parse();\n      console.log(this.props.auth.isAuthenticated)\n      this.props.auth.signout();\n      window.FB.Event.subscribe('auth.statusChange', (response) => {\n        if (response.status === \"connected\") {\n          console.log(response)\n          that.setState({ isLoading: true });\n          window.FB.api('/me', { fields: 'email,name,picture' }, userData => {\n            let registerUser = { thirdparty_id: userData.id, thirdpart_source: 'facebook', email: userData.email, password: 'fb_login', full_name: userData.name };\n            apiModule('authentication_register', {}, registerUser)\n              .then(() => {\n                that.loginThirdParty(userData);\n              })\n          });\n        } else {\n          window.FB.login(response => {\n            if (response.authSuccess) {\n              // dispatch(oauth(\"facebook\"));\n              console.log(response)\n            }\n          }, { scope: \"email,public_profile\", info_fields: \"email,name\" });\n        }\n      });\n    } catch (e) {\n      console.log(e);\n    }\n\n  }\n\n\n  loginThirdParty = (userData) => {\n    const that = this;\n    let postData = { email: userData.email, password: 'fb_login' };\n    apiModule('authentication_login', {}, postData)\n      .then((data) => {\n        if (data.result === 'success') {\n          that.getSession(data);\n        } else {\n          this.setState({ isLoading: false });\n          window.confirm(data.message);\n        }\n      });\n  }\n\n  onSuccess(googleUser) {\n    try {\n      console.log('Logged in as: ' + window.googleUser.getBasicProfile().getName());\n    } catch (err) {\n      console.log(err)\n    }\n  }\n  onFailure(error) {\n    console.log(error);\n  }\n\n  renderButton() {\n    window.gapi.signin2.render('my-signin2', {\n      'scope': 'profile username',\n      'width': 240,\n      'height': 50,\n      'longtitle': true,\n      'theme': 'dark',\n      'onsuccess': this.onSuccess(),\n      'onfailure': this.onFailure()\n    });\n  }\n\n  handlePasswordReadability = () => {\n    (this.state.passwordReadable === true) ?\n      this.setState({ passwordReadable: false }) : this.setState({ passwordReadable: true });\n  }\n\n  handleChangeUsername(event) {\n    this.setState({ username: event.target.value });\n    if (event.target.value)\n      this.setState({ usernameClasses: \"input100 has-val\", usernameMessage: \"Enter username\", usernameValidation: \"wrap-input100 validate-input m-b-35\" });\n    else\n      this.setState({ usernameClasses: \"input100\", usernameMessage: \"Enter username\", usernameValidation: \"wrap-input100 validate-input m-b-35 alert-validate\" });\n  }\n\n  handleChangeBusinesstype(event) {\n    this.setState({ businesstype: event.target.value });\n    if (event.target.value)\n      this.setState({ businesstypeClasses: \"input100 has-val select_force\", businesstypeMessage: \"Enter Valid Business Type\", businesstypeValidation: \"wrap-input100 validate-input m-t-85 m-b-35\" });\n    else\n      this.setState({ businesstypeClasses: \"input100 select_force\", businesstypeMessage: \"Enter Business Type\", businesstypeValidation: \"wrap-input100 validate-input m-t-85 m-b-35 alert-validate\" });\n  }\n\n  handleChangePass(event) {\n    this.setState({ password: event.target.value });\n    if (event.target.value)\n      this.setState({ passClasses: \"input100 has-val\", passwordValidation: \"wrap-input100 validate-input m-b-50\" })\n    else\n      this.setState({\n        passClasses: \"input100\", passwordMessage: \"Enter password\",\n        passwordValidation: \"wrap-input100 validate-input m-b-50 alert-validate\"\n      })\n  }\n\n  validateField(fieldName, value) {\n    let username = true;\n    let password = true;\n    let businesstype = true;\n\n    if (this.state.username.match(/^([\\w.%+-]+)@([\\w-]+\\.)+([\\w]{2,})$/i) === false) {\n      this.setState({\n        usernameValidation: \"wrap-input100 validate-input m-t-85 m-b-35 alert-validate\",\n        usernameMessage: \"Enter username\"\n      });\n      username = false\n    }\n\n    if (!this.state.password) {\n      password = false;\n      this.setState({ passwordValidation: \"wrap-input100 validate-input m-b-50 alert-validate\" })\n    }\n\n    if (!this.state.username) {\n      this.setState({\n        usernameValidation: \"wrap-input100 validate-input m-b-35 alert-validate\",\n        usernameMessage: \"Enter username\"\n      });\n      username = false\n    }\n\n    if (!this.state.businesstype) {\n      this.setState({\n        businesstypeValidation: \"wrap-input100 validate-input m-t-85 force_padding m-b-35 alert-validate\",\n        businesstypeMessage: \"Enter business type\"\n      });\n      businesstype = false\n    }\n\n    // return username === true && password === true ? true : false;\n    return username === true && password === true && businesstype === true\n  }\n\n  async handleSubmit(event) {\n    event.preventDefault();\n    let bool = this.validateField(event);\n    console.log(\"Bool\", bool)\n    if (bool) {\n      this.setState({ isLoading: true });\n      const that = this;\n      let postData = { username: this.state.username, password: this.state.password, businesstype: this.state.businesstype };\n      // let post = jsonToURI(postData);\n      let data = await apiModule('authentication_login', {}, postData);\n      if (data.result === 'success') {\n        this.setState({ isLoading: false });\n        this.getSession(data);\n      } else {\n        this.setState({ isLoading: false });\n        if (data.result === 'expired_password') {\n          that.props.changePageHandler(\"ResetPassword\");\n        } else {\n          window.confirm(data.message);\n        }\n      }\n    }\n  }\n\n  getSession(data) {\n    const that = this;\n    // const userData = data.user;\n    const userData = {\n      contact_number: data.user.contact_number ? encrypt(data.user.contact_number) : \"\",\n      email: encrypt(data.user.email),\n      full_name: encrypt(data.user.full_name),\n      role: data.user.role,\n      business: data.user.business,\n      id: data.user.id,\n\n    }\n    let result = {\n      jwt: data.message,\n      full_name: encrypt(data.user.full_name),\n      user: Object.keys(userData).length ? userData : {},\n      id: 1,\n    };\n    if (data.user.role.name === \"Customer\") {\n      console.log(data);\n      if (data.user.customer) {\n        result.customer = {\n          shipTos: data.user.customer.shipTos,\n          customerType: data.user.customer.customerType,\n          soldTo: data.user.customer.soldTo,\n          soldToName: data.user.customer.soldToName,\n          soldToAddress: data.user.customer.soldToAddress,\n        }\n      } else {\n        result.customer = {\n          shipTos: null,\n          customerType: null,\n          soldTo: null,\n          soldToName: null,\n          soldToAddress: null,\n        }\n      }\n    }\n\n    writeData('users', result);\n    let user = {\n      jwt: data.message,\n      full_name: encrypt(data.user.full_name),\n      user: Object.keys(userData).length ? userData : {},\n    }\n    if (data.user.role.name === \"Customer\") {\n      user.customer = data.user.customer;\n    }\n    that.props.setUserSession(user);\n    that.setState({ isLoading: false })\n    that.askForNotificationPermission()\n    that.props.history.push({ pathname: '/dashboard/home' });\n  }\n\n  /*NOTIFICATION FUNCTIONS*/\n  // displayConfirmNotification = () => {\n\n\n  //   if ('serviceWorker' in navigator) {\n  //     var options = {\n  //       body: message.SUCCESS_PUSH_REGISTRATION,\n  //       icon: 'icons/icon-96x96.png',\n  //       image: 'icons/icon-96x96.png',\n  //       lang: 'en-US', //BCP 47\n  //       vibrate: [100, 50, 200], //vibration pause vibration pause..\n  //       badge: 'icons/icon-96x96.png',\n  //       dir: 'ltr',\n  //       tag: 'confirm-notification',\n  //       renotify: true,\n  //       actions: [\n  //         { action: 'confirm', title: 'Okay' },\n  //         { action: 'cancel', title: 'Cancel' }\n  //       ]\n  //     };\n  //     navigator.serviceWorker.ready\n  //       .then(function (swreg) {\n  //         swreg.showNotification('Successfully subscribed', options)\n  //       });\n  //   }\n  // }\n\n  configurePushSub = () => {\n    let that = this;\n    console.log('configurePushSub ServiceWorker');\n    if (!('serviceWorker' in navigator)) {\n      console.log('No ServiceWorker');\n      return;\n    }\n\n    if ('PushManager' in window) {\n      console.log('We have a push manager');\n\n      var reg;\n      navigator.serviceWorker.ready\n        .then(function (swreg) {\n          reg = swreg;\n          console.log('navigator.serviceWorker.ready');\n          console.log(swreg);\n          let pushManager = swreg.pushManager;\n          console.log(pushManager);\n\n          return pushManager.getSubscription();\n        })\n        .then(function (sub) {\n          if (sub === null) {\n            // Create a new subscription\n            var vapidPublicKey = myConfig.WEB_PUSH_PUBLIC_KEY;\n            var convertedVapidPublicKey = urlBase64ToUint8Array(vapidPublicKey);\n            console.log('Create a new subscription ' + myConfig.WEB_PUSH_PUBLIC_KEY);\n            return reg.pushManager.subscribe({\n              userVisibleOnly: true,\n              applicationServerKey: convertedVapidPublicKey\n            });\n          } else {\n            // We have a subscription\n            console.log('We have a subscription');\n            console.log(sub);\n            return sub;\n          }\n        })\n        .then(function (newSub) {\n          let webpushObject = {\n            'webpush': JSON.stringify(newSub),\n            'type': 'default_push_type'\n          };\n\n          // that.displayConfirmNotification();\n          console.log(newSub);\n          let request = { x_auth: that.props.getSession().jwt }\n          return apiModule('user_store_vapid', request, webpushObject);\n\n\n        })\n        .then(function (res) {\n          console.log(res);\n        })\n        .catch(function (err) {\n          console.log(\"Error : \" + err);\n        });\n    } else {\n\n\n    }\n\n\n  }\n\n  callbackSidebar = (permissionData) => {\n    let that = this;\n    if (permissionData.permission === \"granted\") {\n\n      let webpushObject = {\n        'webpush': permissionData.deviceToken,\n        'type': 'safari_push_type'\n      };\n\n      let data = jsonToURI(webpushObject);\n\n      return apiModule('user_store_vapid', that.props.getSession().jwt, data);\n    }\n  }\n\n  askForNotificationPermission = () => {\n    let that = this;\n\n    if ('PushManager' in window) {\n      Notification.requestPermission(function (result) {\n        console.log('User Choice', result);\n        if (result !== 'granted') {\n          console.log('Not granted');\n        } else {\n          that.configurePushSub();\n        }\n      });\n    } else {\n      console.log('Sorry no push manager. Trying safari server...');\n\n      let result = window.safari.pushNotification.permission(\n        myConfig.SAFARI_WEB_PUSH_ID\n      );\n\n      if (result.permission === \"default\" || result.permission === \"denied\") {\n        window.safari.pushNotification.requestPermission(myConfig.SERVER_URL, myConfig.SAFARI_WEB_PUSH_ID,\n          {}, that.callbackSidebar);\n      } else {\n        console.log(result.permission);\n      }\n      console.log(result);\n    }\n  }\n\n  /* END NOTIFICATION FUNCTION */\n\n  render() {\n\n    var isSafari = window.safari != undefined;\n\n    return (\n      <Fragment>\n        {/* <Helmet>\n          <title>Phoenix Fuels E-POD</title>\n        </Helmet> */}\n        <div className=\"limiter\" style={styles.templateSkin}>\n          <section className=\"login-form\">\n            <div className=\"login-form-wrapper p-t-85 p-b-20\">\n              <form onSubmit={this.handleSubmit} className=\"login100-form validate-form\">\n                <span className=\"login100-form-title login\">\n                  <img className=\"login100-form login100-form__logo\" src={require(\"../assets/images/delivery-system.png\")} alt=\"company logo\" />\n                </span>\n                <div className={this.state.businesstypeValidation} data-validate={this.state.businesstypeMessage}>\n\n\n                  {isSafari ?\n                    <select value={this.state.businesstype} onChange={event => this.handleChangeBusinesstype(event)} className={this.state.businesstypeClasses} name=\"businesstype\">\n                      <option value=\"\" hidden disabled defaultValue>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Business Type</option>\n                      <option value=\"PP\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phoenix Petroleum</option>\n                      <option value=\"JA\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jet A1</option>\n                      <option value=\"PSL\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phoenix Super LPG</option>\n                      <option value=\"PL\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Phoenix Lubricants</option>\n                    </select>\n                    :\n                    <select value={this.state.businesstype} onChange={event => this.handleChangeBusinesstype(event)} className={this.state.businesstypeClasses} name=\"businesstype\">\n                      <option value=\"\" hidden disabled defaultValue>Business Type</option>\n                      <option value=\"PP\">Phoenix Petroleum</option>\n                      <option value=\"JA\">Jet A1</option>\n                      <option value=\"PSL\"> Phoenix Super LPG</option>\n                      <option value=\"PL\">Phoenix Lubricants</option>\n                    </select>}\n\n\n\n                  <span className=\"focus-input100 style_icon icomoon i-business-type\"></span>\n                </div>\n                <div className={this.state.usernameValidation} data-validate={this.state.usernameMessage}>\n                  <input value={this.state.username} onChange={event => this.handleChangeUsername(event)} className={this.state.usernameClasses} type=\"text\" name=\"username\" />\n                  <span className=\"focus-input100 wrap-input__email\" data-placeholder=\"Username\"></span>\n                </div>\n                <PasswordField\n                  fieldName={\"pass\"}\n\n                  containerClass={this.state.passwordValidation}\n                  fieldClass={this.state.passClasses}\n                  fieldValue={this.state.password}\n\n                  changeHandler={this.handleChangePass}\n                  readabilityHandler={this.handlePasswordReadability}\n\n                  readabilityIcon={true}\n                  readabilityClass={this.state.passwordReadable}\n                >\n                  Password\n                </PasswordField>\n                <div className=\"login-form-form-btn\">\n                  <button className=\"login100-form-btn\">Log In</button>\n                </div>\n                <label className=\"regular-label forgot-label\"><u className=\"regular__link\" onClick={() => this.props.changePageHandler(\"ForgotPassword\")} ><Link style={{ textDecoration: 'none', color: '#000000' }} to=\"/forgot-password\">Forgot your password?</Link></u></label>\n              </form>\n            </div>\n            <footer>\n              <div className=\"login-form-footer\">\n                <a target=\"_blank\" href=\"https://www.phoenixfuels.ph/contact-us\" className=\"login-form-footer__text pr-1\">Contact |</a>\n                <a target=\"_blank\" href=\"https://www.phoenixfuels.ph\" className=\"login-form-footer__text\">Phoenix Petroleum Philippines, Inc. | Copyright 2019</a>\n              </div>\n            </footer>\n          </section>\n          <figure className=\"login-image\">\n            <img className=\"login-image__background\" src={require(\"../assets/images/bg-login.png\")} alt=\"login background\" />\n          </figure>\n          <Loader show={this.state.isLoading} />\n        </div>\n      </Fragment >\n    );\n  }\n}\n\nexport default withRouter(Login);\n"]},"metadata":{},"sourceType":"module"}